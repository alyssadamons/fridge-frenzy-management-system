@page
@model ChangePasswordModel
@{
    Layout = "_Layout";
    ViewData["Title"] = "Change password";
    ViewData["ActivePage"] = ManageNavPages.ChangePassword;
}

<style>
    .password-toggle {
        position: absolute;
        right: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        border: none;
        background: transparent;
        color: #888;
        font-size: 1.2rem;
        cursor: pointer;
        z-index: 5;
    }

        .password-toggle:hover {
            color: #0d6efd;
        }

    .form-control {
        border-radius: 0.5rem;
        border: 1px solid #ccc;
        padding: 0.75rem 1rem;
        font-size: 1rem;
        transition: all 0.2s ease;
    }

        .form-control:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.2rem rgba(13,110,253,0.15);
        }

    .btn-primary {
        border-radius: 0.75rem;
        font-size: 1.1rem;
        padding: 0.9rem;
        transition: all 0.2s ease;
    }

    .position-relative {
        position: relative;
    }
</style>

<div class="container py-4">
    <div class="row">
        <div class="col-lg-3 mb-4">
            <partial name="_ManageNav" />
        </div>
        <div class="col-lg-9">
            <div class="card shadow-sm border-0">
                <div class="card-header bg-primary text-white py-3">
                    <h4 class="mb-0"><i class="fas fa-lock me-2"></i>@ViewData["Title"]</h4>
                </div>
                <div class="card-body p-4">
                    <partial name="_StatusMessage" for="StatusMessage" />

                    <form id="change-password-form" method="post">
                        <div class="row justify-content-center">
                            <div class="col-md-8">
                                <!-- Current Password -->
                                <div class="mb-4">
                                    <label asp-for="Input.OldPassword" class="form-label fw-semibold">Current Password</label>
                                    <div class="position-relative">
                                        <input asp-for="Input.OldPassword" class="form-control pe-5" type="password"
                                               autocomplete="current-password" id="oldPassword"
                                               placeholder="Enter your current password" />
                                        <button type="button" id="toggleOldPassword" class="password-toggle">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <span asp-validation-for="Input.OldPassword" class="text-danger small mt-1 d-block"></span>
                                </div>

                                <!-- New Password -->
                                <div class="mb-4">
                                    <label asp-for="Input.NewPassword" class="form-label fw-semibold">New Password</label>
                                    <div class="position-relative">
                                        <input asp-for="Input.NewPassword" class="form-control pe-5" type="password"
                                               autocomplete="new-password" id="newPassword"
                                               placeholder="Enter your new password" />
                                        <button type="button" id="toggleNewPassword" class="password-toggle">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <span asp-validation-for="Input.NewPassword" class="text-danger small mt-1 d-block"></span>
                                </div>

                                <!-- Confirm Password -->
                                <div class="mb-4">
                                    <label asp-for="Input.ConfirmPassword" class="form-label fw-semibold">Confirm New Password</label>
                                    <div class="position-relative">
                                        <input asp-for="Input.ConfirmPassword" class="form-control pe-5" type="password"
                                               autocomplete="new-password" id="confirmPassword"
                                               placeholder="Confirm your new password" />
                                        <button type="button" id="toggleConfirmPassword" class="password-toggle">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <span asp-validation-for="Input.ConfirmPassword" class="text-danger small mt-1 d-block"></span>
                                </div>

                                <button type="submit" class="btn btn-primary w-100 py-3 mt-3">
                                    <i class="fas fa-key me-2"></i>Update Password
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Toggle old password visibility
            const toggleOldPassword = document.getElementById('toggleOldPassword');
            const oldPassword = document.getElementById('oldPassword');

            if (toggleOldPassword && oldPassword) {
                toggleOldPassword.addEventListener('click', function() {
                    const type = oldPassword.getAttribute('type') === 'password' ? 'text' : 'password';
                    oldPassword.setAttribute('type', type);
                    const icon = toggleOldPassword.querySelector('i');
                    if (icon) {
                        icon.className = type === 'password' ? 'fas fa-eye' : 'fas fa-eye-slash';
                    }
                });
            }

            // Toggle new password visibility
            const toggleNewPassword = document.getElementById('toggleNewPassword');
            const newPassword = document.getElementById('newPassword');

            if (toggleNewPassword && newPassword) {
                toggleNewPassword.addEventListener('click', function() {
                    const type = newPassword.getAttribute('type') === 'password' ? 'text' : 'password';
                    newPassword.setAttribute('type', type);
                    const icon = toggleNewPassword.querySelector('i');
                    if (icon) {
                        icon.className = type === 'password' ? 'fas fa-eye' : 'fas fa-eye-slash';
                    }
                });
            }

            // Toggle confirm password visibility
            const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
            const confirmPassword = document.getElementById('confirmPassword');

            if (toggleConfirmPassword && confirmPassword) {
                toggleConfirmPassword.addEventListener('click', function() {
                    const type = confirmPassword.getAttribute('type') === 'password' ? 'text' : 'password';
                    confirmPassword.setAttribute('type', type);
                    const icon = toggleConfirmPassword.querySelector('i');
                    if (icon) {
                        icon.className = type === 'password' ? 'fas fa-eye' : 'fas fa-eye-slash';
                    }
                });
            }
        });
    </script>
}